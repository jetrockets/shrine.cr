{"repository_name":"github.com/jetrockets/shrine.cr","body":"[![Build Status](https://travis-ci.org/jetrockets/shrine.cr.svg?branch=master)](https://travis-ci.org/jetrockets/shrine.cr)\n\n# shrine.cr\n\nShrine is a toolkit for file attachments in Crystal applications. Heavily inspired by [Shrine for Ruby](https://shrinerb.com).\n\n## Documentation\n\n[https://jetrockets.github.io/shrine.cr](https://jetrockets.github.io/shrine.cr)\n\n## Installation\n\n1. Add the dependency to your `shard.yml`:\n\n   ```yaml\n   dependencies:\n     shrine.cr:\n       github: jetrockets/shrine.cr\n   ```\n\n2. Run `shards install`\n\n## Usage\n\n```crystal\nrequire \"shrine.cr\"\n```\n\nShrine.cr is under heavy development!\n\nFirst of all you should configure `Shrine`.\n\n``` crystal\nShrine.configure do |config|\n  config.storages[\"cache\"] = Storage::FileSystem.new(\"uploads\", prefix: \"cache\")\n  config.storages[\"store\"] = Storage::FileSystem.new(\"uploads\")\nend\n```\n\nNow you can use `Shrine` directly to upload your files.\n\n``` crystal\nShrine.upload(file, :store)\n```\n\n`Shrine.upload` method supports additional argument just like Shrine.rb. For example we want our file to have a custom filename.\n\n``` crystal\nShrine.upload(file, :store, metadata: { filename: \"foo.bar\" })\n```\n\n### Custom uploaders\n\nTo implement custom uploader class just inherit it from `Shrine`. You can override `Shrine` methods to implement custom logic. Here is an example how to create a custom file location.\n\n``` crystal\nclass FileImport::AssetUploader < Shrine\n  def generate_location(io : IO | UploadedFile, metadata, context, **options)\n    name = super(io, metadata, **options)\n\n    File.join(\"imports\", context[:model].id.to_s, name)\n  end\nend\n\nFileImport::AssetUploader.upload(file, :store, context: { model: YOUR_ORM_MODEL } })\n```\n\n### S3 storage\n\n#### Creating a Client\n\n``` crystal\nclient = Awscr::S3::Client.new(\"region\", \"key\", \"secret\")\n```\n\nFor S3 compatible services, like DigitalOcean Spaces or Minio, you'll need to set a custom endpoint:\n\n``` crystal\nclient = Awscr::S3::Client.new(\"nyc3\", \"key\", \"secret\", endpoint: \"https://nyc3.digitaloceanspaces.com\")\n```\n\n\n#### Create a S3 storage\n\nThe storage is initialized by providing your bucket and client:\n\n```crystal\nstorage = Shrine::Storage::S3.new(bucket: \"bucket_name\", client: client, prefix: \"prefix\")\n```\n\nSometimes you'll want to add additional upload options to all S3 uploads. You can do that by passing the :upload_options option:\n\n```crystal\nstorage = Shrine::Storage::S3.new(bucket: \"bucket_name\", client: client, upload_options: { \"x-amz-acl\"=> \"public-read\" })\n```\n\nYou can tell S3 storage to make uploads public:\n\n```crystal\nstorage = Shrine::Storage::S3.new(bucket: \"bucket_name\", client: client, public: true)\n```\n\n### ORM usage example\n\nCurrently ORM adapters are not implmented.\n\n#### Granite.\n\n``` crystal\nclass FileImport < Granite::Base\n  connection pg\n  table file_imports\n\n  column id : Int64, primary: true\n  column asset_data : Shrine::UploadedFile, converter: Granite::Converters::Json(Shrine::UploadedFile, JSON::Any)\n\n  after_save do\n    if @asset_changed && @asset_data\n      @asset_data = FileImport::AssetUploader.store(@asset_data.not_nil!, move: true, context: { model: self })\n      @asset_changed = false\n\n      save!\n    end\n  end\n\n  def asset=(upload : Amber::Router::File)\n    @asset_data = FileImport::AssetUploader.cache(upload.file, metadata: { filename: upload.filename })\n    @asset_changed = true\n  end\nend\n\n```\n\n#### Jennifer\n\n``` crystal\nclass FileImport < Jennifer::Model::Base\n  @asset_changed : Bool | Nil\n\n  with_timestamps\n\n  mapping(\n    id: Primary32,\n    asset_data: JSON::Any?,\n    created_at: Time?,\n    updated_at: Time?\n  )\n\n  after_save :move_to_store\n\n  def asset=(upload : Amber::Router::File)\n    self.asset_data = JSON.parse(FileImport::AssetUploader.cache(upload.file, metadata: { filename: upload.filename }).to_json)\n    asset_changed! if asset_data\n  end\n\n  def asset\n    Shrine::UploadedFile.from_json(asset_data.not_nil!.to_json) if asset_data\n  end\n\n  def asset_changed?\n    @asset_changed || false\n  end\n\n  private def asset_changed!\n    @asset_changed = true\n  end\n\n  private def move_to_store\n    if asset_changed?\n      self.asset_data = JSON.parse(FileImport::AssetUploader.store(asset.not_nil!, move: true, context: { model: self }).to_json)\n      @asset_changed = false\n      save!\n    end\n  end\nend\n\n```\n\n## Plugins\n\nShrine.cr has a plugins interface similar to Shrine.rb. You can extend functionality of uploaders inherited from `Shrine` and also extend `UploadedFile` class.\n\n### Determine MIME Type\n\nThe `DetermineMimeType` plugin is used to get mime type of uploaded file in several ways.\n\n``` crystal\nclass Uploader < Shrine\n  load_plugin(\n    Shrine::Plugins::DetermineMimeType,\n    analyzer: Shrine::Plugins::DetermineMimeType::Tools::File\n  )\n\n  finalize_plugins!\nend\n```\n**Analyzers**\n\nThe following analyzers are accepted:\n\n| Name            | Description                                                                                                                                                                                                         |\n|-----------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| `File`         | (**Default**). Uses the file utility to determine the MIME type from file contents. It is installed by default on most operating systems.                                                                           |\n| `Mime`         | Uses the [MIME.from_filename](https://crystal-lang.org/api/0.31.1/MIME.html) method to determine the MIME type from file.                                                                                               |\n| `ContentType` | Retrieves the value of the `#content_type` attribute of the IO object. Note that this value normally comes from the \"Content-Type\" request header, so it's not guaranteed to hold the actual MIME type of the file. |\n\n\n### Add Metadata\n\nThe `AddMetadata` plugin provides a convenient method for extracting and adding custom metadata values.\n\n``` crystal\nrequire \"base64\"\n\nclass Uploader < Shrine\n  load_plugin(Shrine::Plugins::AddMetadata)\n\n  add_metadata :signature, -> {\n    Base64.encode(io.gets_to_end)\n  }\n\n  finalize_plugins!\nend\n```\n\nThe above will add `\"signature\"` to the metadata hash.\n\n``` crystal\nimage.metadata[\"signature\"]\n```\n\n**Multiple values**\n\nYou can also extract multiple metadata values at once.\n\n``` crystal\nclass Uploader < Shrine\n  load_plugin(Shrine::Plugins::AddMetadata)\n\n  add_metadata :multiple_values, -> {\n    text = io.gets_to_end\n\n    Shrine::UploadedFile::MetadataType{\n      \"custom_1\" => text,\n      \"custom_2\" => text * 2\n    }\n  }\n\n  finalize_plugins!\nend\n```\n\n``` crystal\nimage.metadata[\"custom_1\"]\nimage.metadata[\"custom_2\"]\n```\n\n\n## Feature Progress\n\nIn no particular order, features that have been implemented and are planned.\nItems not marked as completed may have partial implementations.\n\n- [X] Shrine\n- [X] Shrine::UploadedFile\n    - [ ] ==\n    - [X] #original_filename\n    - [X] #extension\n    - [X] #size\n    - [X] #mime_type\n    - [X] #close\n    - [X] #url\n    - [X] #exists?\n    - [X] #open\n    - [X] #download\n    - [X] #stream\n    - [X] #replace\n    - [X] #delete\n- [ ] Shrine::Attacher\n- [ ] Shrine::Attachment\n- [ ] Shrine::Storage\n    - [X] Shrine::Storage::Memory\n    - [X] Shrine::Storage::FileSystem\n    - [X] Shrine::Storage::S3\n- [ ] Uploaders\n    - [X] Custom uploaders\n    - [ ] Derivatives\n- [ ] ORM adapters\n    - [ ] `Granite` [https://github.com/amberframework/granite](https://github.com/amberframework/granite)\n    - [ ] `crecto` [https://github.com/Crecto/crecto](https://github.com/Crecto/crecto)\n    - [ ] `jennifer.cr` [https://github.com/imdrasil/jennifer.cr](https://github.com/imdrasil/jennifer.cr)\n    - [ ] `Avram` [https://github.com/luckyframework/avram](https://github.com/luckyframework/avram)\n- [X] Plugins\n- [ ] Background processing\n\n\n## Contributing\n\n1. Fork it (<https://github.com/your-github-user/shrine.cr/fork>)\n2. Create your feature branch (`git checkout -b my-new-feature`)\n3. Commit your changes (`git commit -am 'Add some feature'`)\n4. Push to the branch (`git push origin my-new-feature`)\n5. Create a new Pull Request\n\n## Contributors\n\n- [Igor Alexandrov](https://github.com/igor-alexandrov) - creator and maintainer\n- [Arina Shmeleva](https://github.com/arina1004) - helped with S3 Storage\n","program":{"html_id":"github.com/jetrockets/shrine.cr/toplevel","path":"toplevel.html","kind":"module","full_name":"Top Level Namespace","name":"Top Level Namespace","abstract":false,"superclass":null,"ancestors":[],"locations":[],"repository_name":"github.com/jetrockets/shrine.cr","program":true,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":null,"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[{"html_id":"github.com/jetrockets/shrine.cr/Shrine","path":"Shrine.html","kind":"class","full_name":"Shrine","name":"Shrine","abstract":false,"superclass":{"html_id":"github.com/jetrockets/shrine.cr/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"github.com/jetrockets/shrine.cr/Shrine/InstanceMethods","kind":"module","full_name":"Shrine::InstanceMethods","name":"InstanceMethods"},{"html_id":"github.com/jetrockets/shrine.cr/Habitat/SettingsHelpers","kind":"module","full_name":"Habitat::SettingsHelpers","name":"SettingsHelpers"},{"html_id":"github.com/jetrockets/shrine.cr/Habitat/TempConfig","kind":"module","full_name":"Habitat::TempConfig","name":"TempConfig"},{"html_id":"github.com/jetrockets/shrine.cr/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"github.com/jetrockets/shrine.cr/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"shrine/storage/base.cr","line_number":3,"url":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/base.cr"},{"filename":"shrine/storage/file_system.cr","line_number":3,"url":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/file_system.cr"},{"filename":"shrine/storage/memory.cr","line_number":3,"url":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/memory.cr"},{"filename":"shrine/storage/s3.cr","line_number":5,"url":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/s3.cr"},{"filename":"shrine/plugins/add_metadata.cr","line_number":1,"url":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/plugins/add_metadata.cr"},{"filename":"shrine/plugins/determine_mime_type.cr","line_number":3,"url":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/plugins/determine_mime_type.cr"},{"filename":"shrine/uploaded_file.cr","line_number":3,"url":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/uploaded_file.cr"},{"filename":"shrine.cr","line_number":9,"url":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine.cr"}],"repository_name":"github.com/jetrockets/shrine.cr","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[{"id":"HABITAT_SETTINGS","name":"HABITAT_SETTINGS","value":"[{decl: storages : Hash(String, Storage::Base) = Hash(String, Storage::Base).new, example: nil}, {decl: log_level : Logger::Severity = Logger::WARN, example: nil}] of Nil","doc":null,"summary":null},{"id":"PLUGINS","name":"PLUGINS","value":"[] of Nil","doc":null,"summary":null}],"included_modules":[{"html_id":"github.com/jetrockets/shrine.cr/Habitat/SettingsHelpers","kind":"module","full_name":"Habitat::SettingsHelpers","name":"SettingsHelpers"},{"html_id":"github.com/jetrockets/shrine.cr/Habitat/TempConfig","kind":"module","full_name":"Habitat::TempConfig","name":"TempConfig"},{"html_id":"github.com/jetrockets/shrine.cr/Shrine/InstanceMethods","kind":"module","full_name":"Shrine::InstanceMethods","name":"InstanceMethods"}],"extended_modules":[{"html_id":"github.com/jetrockets/shrine.cr/Shrine/ClassMethods","kind":"module","full_name":"Shrine::ClassMethods","name":"ClassMethods"}],"subclasses":[],"including_types":[],"namespace":null,"doc":null,"summary":null,"class_methods":[{"id":"configure(&)-class-method","html_id":"configure(&amp;)-class-method","name":"configure","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"(&)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine.cr#L25","def":{"name":"configure","args":[],"double_splat":null,"splat_index":null,"yields":1,"block_arg":null,"return_type":"","visibility":"Public","body":"yield settings"}},{"id":"logger-class-method","html_id":"logger-class-method","name":"logger","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":null,"def":{"name":"logger","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@@logger"}},{"id":"logger=(logger)-class-method","html_id":"logger=(logger)-class-method","name":"logger=","doc":null,"summary":null,"abstract":false,"args":[{"name":"logger","doc":null,"default_value":"","external_name":"logger","restriction":""}],"args_string":"(logger)","source_link":null,"def":{"name":"logger=","args":[{"name":"logger","doc":null,"default_value":"","external_name":"logger","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@@logger = logger"}},{"id":"plugin_settings-class-method","html_id":"plugin_settings-class-method","name":"plugin_settings","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine.cr#L36","def":{"name":"plugin_settings","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"PluginSettings.new"}},{"id":"settings-class-method","html_id":"settings-class-method","name":"settings","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine.cr#L25","def":{"name":"settings","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"Settings"}}],"constructors":[],"instance_methods":[{"id":"settings-instance-method","html_id":"settings-instance-method","name":"settings","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine.cr#L25","def":{"name":"settings","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"Settings"}}],"macros":[{"id":"finalize_plugins!-macro","html_id":"finalize_plugins!-macro","name":"finalize_plugins!","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine.cr#L91","def":{"name":"finalize_plugins!","args":[],"double_splat":null,"splat_index":null,"block_arg":null,"visibility":"Public","body":"    class PluginsSettings\n      def all\n        \n{% if @type.constant(:PLUGINS) %}\n          {{ (@type.constant(:PLUGINS)).map do |plugin|\n  options = (plugin[:options].empty? ? nil : plugin[:options])\n  {name: (plugin[:decl].stringify.underscore.split(\"::\")).last, options: options}\nend }}\n        {% end %}\n\n      \nend\n\n      def [](key : Symbol | String)\n        all.find\n{ |plugin| plugin[:name] == key.to_s}.try &.[:options]\n      \nend\n\n      \n{% for plugin in @type.constant(:PLUGINS) %}\n        def {{ (plugin[:decl].stringify.underscore.split(\"::\")).last.id }}\n          {% if plugin[:options].empty? %}\n            nil\n          {% else %}\n            {{ plugin[:options] }}\n          {% end %}\n        end\n      {% end %}\n\n    \nend\n\n    def self.plugin_settings\n      PluginsSettings.new\n    \nend\n  \n"}},{"id":"load_plugin(plugin,**args)-macro","html_id":"load_plugin(plugin,**args)-macro","name":"load_plugin","doc":null,"summary":null,"abstract":false,"args":[{"name":"plugin","doc":null,"default_value":"","external_name":"plugin","restriction":""}],"args_string":"(plugin, **args)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine.cr#L48","def":{"name":"load_plugin","args":[{"name":"plugin","doc":null,"default_value":"","external_name":"plugin","restriction":""}],"double_splat":{"name":"args","doc":null,"default_value":"","external_name":"args","restriction":""},"splat_index":null,"block_arg":null,"visibility":"Public","body":"    \n{% plugin = plugin.resolve %}\n\n    \n{% options = args %}\n\n\n    \n{% if PLUGINS.map do |e|\n  e[:decl]\nend.includes?(plugin) %}\n      raise ArgumentError.new(\"Cannot load plugin {{ plugin.stringify }} to {{ @type }}. Plugin has already been initialized\")\n    {% else %}\n      {% if plugin.constant(:DEFAULT_OPTIONS) %}\n        {% if !options %}\n          {% options = plugin.constant(:DEFAULT_OPTIONS) %}\n        {% end %}\n\n        {% for key in (plugin.constant(:DEFAULT_OPTIONS)).keys %}\n          {% if options[key] %}{% else %}\n            {{ options[key] = (plugin.constant(:DEFAULT_OPTIONS))[key] }}\n          {% end %}\n        {% end %}\n      {% end %}\n\n      {% PLUGINS << {decl: plugin, options: options} %}\n    {% end %}\n\n\n    \n{% if plugin.constant(:InstanceMethods) %}\n      include {{ plugin.constant(:InstanceMethods) }}\n    {% end %}\n\n\n    \n{% if plugin.constant(:ClassMethods) %}\n      extend {{ plugin.constant(:ClassMethods) }}\n    {% end %}\n\n\n    \n{% if plugin.constant(:FileClassMethods) %}\n      class UploadedFile < Shrine::UploadedFile\n        extend {{ plugin.constant(:FileClassMethods) }}\n      end\n    {% end %}\n\n\n    \n{% if plugin.constant(:FileMethods) %}\n      class UploadedFile < Shrine::UploadedFile\n        include {{ plugin.constant(:FileMethods) }}\n      end\n    {% end %}\n\n  \n"}}],"types":[{"html_id":"github.com/jetrockets/shrine.cr/Shrine/ClassMethods","path":"Shrine/ClassMethods.html","kind":"module","full_name":"Shrine::ClassMethods","name":"ClassMethods","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"shrine.cr","line_number":128,"url":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine.cr"}],"repository_name":"github.com/jetrockets/shrine.cr","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/jetrockets/shrine.cr/Shrine","kind":"class","full_name":"Shrine","name":"Shrine"},"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[{"id":"cache(io,**options)-instance-method","html_id":"cache(io,**options)-instance-method","name":"cache","doc":null,"summary":null,"abstract":false,"args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":""}],"args_string":"(io, **options)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine.cr#L147","def":{"name":"cache","args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":""}],"double_splat":{"name":"options","doc":null,"default_value":"","external_name":"options","restriction":""},"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"(new(\"cache\")).upload(io, **options)"}},{"id":"find_storage(name:String)-instance-method","html_id":"find_storage(name:String)-instance-method","name":"find_storage","doc":"Retrieves the storage under the given identifier (Symbol), raising Shrine::Error if the storage is missing.","summary":"<p>Retrieves the storage under the given identifier (Symbol), raising Shrine::Error if the storage is missing.</p>","abstract":false,"args":[{"name":"name","doc":null,"default_value":"","external_name":"name","restriction":"String"}],"args_string":"(name : String)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine.cr#L134","def":{"name":"find_storage","args":[{"name":"name","doc":null,"default_value":"","external_name":"name","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"settings.storages[name]? || (raise(Error.new(\"storage #{name.inspect} isn't registered on #{self}\")))"}},{"id":"raise_if_missing_settings!-instance-method","html_id":"raise_if_missing_settings!-instance-method","name":"raise_if_missing_settings!","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine.cr#L155","def":{"name":"raise_if_missing_settings!","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"Habitat.raise_if_missing_settings!"}},{"id":"store(io,**options)-instance-method","html_id":"store(io,**options)-instance-method","name":"store","doc":null,"summary":null,"abstract":false,"args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":""}],"args_string":"(io, **options)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine.cr#L151","def":{"name":"store","args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":""}],"double_splat":{"name":"options","doc":null,"default_value":"","external_name":"options","restriction":""},"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"(new(\"store\")).upload(io, **options)"}},{"id":"upload(io,storage,**options)-instance-method","html_id":"upload(io,storage,**options)-instance-method","name":"upload","doc":"Uploads the file to the specified storage. It delegates to `Shrine#upload`.\n\n```\nShrine.upload(io, :store) # => #<Shrine::UploadedFile>\n```","summary":"<p>Uploads the file to the specified storage.</p>","abstract":false,"args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":""},{"name":"storage","doc":null,"default_value":"","external_name":"storage","restriction":""}],"args_string":"(io, storage, **options)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine.cr#L143","def":{"name":"upload","args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":""},{"name":"storage","doc":null,"default_value":"","external_name":"storage","restriction":""}],"double_splat":{"name":"options","doc":null,"default_value":"","external_name":"options","restriction":""},"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"(new(storage)).upload(io, **options)"}},{"id":"warn(message)-instance-method","html_id":"warn(message)-instance-method","name":"warn","doc":"Prints a warning to the logger.","summary":"<p>Prints a warning to the logger.</p>","abstract":false,"args":[{"name":"message","doc":null,"default_value":"","external_name":"message","restriction":""}],"args_string":"(message)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine.cr#L160","def":{"name":"warn","args":[{"name":"message","doc":null,"default_value":"","external_name":"message","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"Shrine.logger.warn(\"SHRINE WARNING: #{message}\")"}}],"macros":[],"types":[]},{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Error","path":"Shrine/Error.html","kind":"class","full_name":"Shrine::Error","name":"Error","abstract":false,"superclass":{"html_id":"github.com/jetrockets/shrine.cr/Exception","kind":"class","full_name":"Exception","name":"Exception"},"ancestors":[{"html_id":"github.com/jetrockets/shrine.cr/Exception","kind":"class","full_name":"Exception","name":"Exception"},{"html_id":"github.com/jetrockets/shrine.cr/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"github.com/jetrockets/shrine.cr/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"shrine.cr","line_number":12,"url":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine.cr"}],"repository_name":"github.com/jetrockets/shrine.cr","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[{"html_id":"github.com/jetrockets/shrine.cr/Shrine/FileNotFound","kind":"class","full_name":"Shrine::FileNotFound","name":"FileNotFound"},{"html_id":"github.com/jetrockets/shrine.cr/Shrine/InvalidFile","kind":"class","full_name":"Shrine::InvalidFile","name":"InvalidFile"}],"including_types":[],"namespace":{"html_id":"github.com/jetrockets/shrine.cr/Shrine","kind":"class","full_name":"Shrine","name":"Shrine"},"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[]},{"html_id":"github.com/jetrockets/shrine.cr/Shrine/FileNotFound","path":"Shrine/FileNotFound.html","kind":"class","full_name":"Shrine::FileNotFound","name":"FileNotFound","abstract":false,"superclass":{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Error","kind":"class","full_name":"Shrine::Error","name":"Error"},"ancestors":[{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Error","kind":"class","full_name":"Shrine::Error","name":"Error"},{"html_id":"github.com/jetrockets/shrine.cr/Exception","kind":"class","full_name":"Exception","name":"Exception"},{"html_id":"github.com/jetrockets/shrine.cr/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"github.com/jetrockets/shrine.cr/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"shrine.cr","line_number":22,"url":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine.cr"}],"repository_name":"github.com/jetrockets/shrine.cr","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/jetrockets/shrine.cr/Shrine","kind":"class","full_name":"Shrine","name":"Shrine"},"doc":"Raised by the storage in the #open method.","summary":"<p>Raised by the storage in the #open method.</p>","class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[]},{"html_id":"github.com/jetrockets/shrine.cr/Shrine/InstanceMethods","path":"Shrine/InstanceMethods.html","kind":"module","full_name":"Shrine::InstanceMethods","name":"InstanceMethods","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"shrine.cr","line_number":165,"url":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine.cr"}],"repository_name":"github.com/jetrockets/shrine.cr","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[{"html_id":"github.com/jetrockets/shrine.cr/Shrine","kind":"class","full_name":"Shrine","name":"Shrine"}],"namespace":{"html_id":"github.com/jetrockets/shrine.cr/Shrine","kind":"class","full_name":"Shrine","name":"Shrine"},"doc":null,"summary":null,"class_methods":[],"constructors":[{"id":"new(storage_key:String)-class-method","html_id":"new(storage_key:String)-class-method","name":"new","doc":null,"summary":null,"abstract":false,"args":[{"name":"storage_key","doc":null,"default_value":"","external_name":"storage_key","restriction":"String"}],"args_string":"(storage_key : String)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine.cr#L168","def":{"name":"new","args":[{"name":"storage_key","doc":null,"default_value":"","external_name":"storage_key","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize(storage_key)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"id":"generate_location(io:IO|UploadedFile,metadata,**options)-instance-method","html_id":"generate_location(io:IO|UploadedFile,metadata,**options)-instance-method","name":"generate_location","doc":"Generates a unique location for the uploaded file, preserving the\nfile extension. Can be overriden in uploaders for generating custom\nlocation.","summary":"<p>Generates a unique location for the uploaded file, preserving the file extension.</p>","abstract":false,"args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":"IO | UploadedFile"},{"name":"metadata","doc":null,"default_value":"","external_name":"metadata","restriction":""}],"args_string":"(io : IO | UploadedFile, metadata, **options)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine.cr#L201","def":{"name":"generate_location","args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":"IO | UploadedFile"},{"name":"metadata","doc":null,"default_value":"","external_name":"metadata","restriction":""}],"double_splat":{"name":"options","doc":null,"default_value":"","external_name":"options","restriction":""},"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"basic_location(io, metadata: metadata)"}},{"id":"generate_uid(io)-instance-method","html_id":"generate_uid(io)-instance-method","name":"generate_uid","doc":"Generates a unique identifier that can be used for a location.","summary":"<p>Generates a unique identifier that can be used for a location.</p>","abstract":false,"args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":""}],"args_string":"(io)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine.cr#L287","def":{"name":"generate_uid","args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"Random.new.hex"}},{"id":"storage-instance-method","html_id":"storage-instance-method","name":"storage","doc":"Returns the storage object referenced by the identifier.","summary":"<p>Returns the storage object referenced by the identifier.</p>","abstract":false,"args":[],"args_string":"","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine.cr#L172","def":{"name":"storage","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"self.class.find_storage(storage_key)"}},{"id":"storage_key:String-instance-method","html_id":"storage_key:String-instance-method","name":"storage_key","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : String","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine.cr#L166","def":{"name":"storage_key","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"@storage_key"}},{"id":"upload(io:IO|UploadedFile,**options)-instance-method","html_id":"upload(io:IO|UploadedFile,**options)-instance-method","name":"upload","doc":"The main method for uploading files. Takes an IO-like object and an\noptional context hash (used internally by Shrine::Attacher). It calls\nuser-defined #process, and afterwards it calls #store. The `io` is\nclosed after upload.\n\n  uploader.upload(io)\n  uploader.upload(io, metadata: { \"foo\" => \"bar\" })           # add metadata\n  uploader.upload(io, location: \"path/to/file\")               # specify location\n  uploader.upload(io, upload_options: { acl: \"public-read\" }) # add upload options","summary":"<p>The main method for uploading files.</p>","abstract":false,"args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":"IO | UploadedFile"}],"args_string":"(io : IO | UploadedFile, **options)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine.cr#L185","def":{"name":"upload","args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":"IO | UploadedFile"}],"double_splat":{"name":"options","doc":null,"default_value":"","external_name":"options","restriction":""},"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"metadata = get_metadata(io, **options)\nlocation = get_location(io, **options.merge(metadata: metadata))\n_upload(io, **options.merge(location: location, metadata: metadata))\nUploadedFile.new(id: location, storage: storage_key, metadata: metadata)\n"}},{"id":"warn(message)-instance-method","html_id":"warn(message)-instance-method","name":"warn","doc":"Prints a warning to the logger.","summary":"<p>Prints a warning to the logger.</p>","abstract":false,"args":[{"name":"message","doc":null,"default_value":"","external_name":"message","restriction":""}],"args_string":"(message)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine.cr#L206","def":{"name":"warn","args":[{"name":"message","doc":null,"default_value":"","external_name":"message","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"Shrine.logger.warn(\"SHRINE WARNING: #{message}\")"}}],"macros":[],"types":[]},{"html_id":"github.com/jetrockets/shrine.cr/Shrine/InvalidFile","path":"Shrine/InvalidFile.html","kind":"class","full_name":"Shrine::InvalidFile","name":"InvalidFile","abstract":false,"superclass":{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Error","kind":"class","full_name":"Shrine::Error","name":"Error"},"ancestors":[{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Error","kind":"class","full_name":"Shrine::Error","name":"Error"},{"html_id":"github.com/jetrockets/shrine.cr/Exception","kind":"class","full_name":"Exception","name":"Exception"},{"html_id":"github.com/jetrockets/shrine.cr/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"github.com/jetrockets/shrine.cr/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"shrine.cr","line_number":15,"url":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine.cr"}],"repository_name":"github.com/jetrockets/shrine.cr","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/jetrockets/shrine.cr/Shrine","kind":"class","full_name":"Shrine","name":"Shrine"},"doc":"Raised when a file is not a valid IO.","summary":"<p>Raised when a file is not a valid IO.</p>","class_methods":[],"constructors":[{"id":"new(io,missing_methods)-class-method","html_id":"new(io,missing_methods)-class-method","name":"new","doc":null,"summary":null,"abstract":false,"args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":""},{"name":"missing_methods","doc":null,"default_value":"","external_name":"missing_methods","restriction":""}],"args_string":"(io, missing_methods)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine.cr#L16","def":{"name":"new","args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":""},{"name":"missing_methods","doc":null,"default_value":"","external_name":"missing_methods","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize(io, missing_methods)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[],"macros":[],"types":[]},{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Plugins","path":"Shrine/Plugins.html","kind":"module","full_name":"Shrine::Plugins","name":"Plugins","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"shrine/plugins/add_metadata.cr","line_number":2,"url":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/plugins/add_metadata.cr"},{"filename":"shrine/plugins/determine_mime_type.cr","line_number":4,"url":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/plugins/determine_mime_type.cr"}],"repository_name":"github.com/jetrockets/shrine.cr","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/jetrockets/shrine.cr/Shrine","kind":"class","full_name":"Shrine","name":"Shrine"},"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Plugins/AddMetadata","path":"Shrine/Plugins/AddMetadata.html","kind":"module","full_name":"Shrine::Plugins::AddMetadata","name":"AddMetadata","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"shrine/plugins/add_metadata.cr","line_number":3,"url":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/plugins/add_metadata.cr"}],"repository_name":"github.com/jetrockets/shrine.cr","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Plugins","kind":"module","full_name":"Shrine::Plugins","name":"Plugins"},"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Plugins/AddMetadata/InstanceMethods","path":"Shrine/Plugins/AddMetadata/InstanceMethods.html","kind":"module","full_name":"Shrine::Plugins::AddMetadata::InstanceMethods","name":"InstanceMethods","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"shrine/plugins/add_metadata.cr","line_number":4,"url":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/plugins/add_metadata.cr"}],"repository_name":"github.com/jetrockets/shrine.cr","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[{"id":"CUSTOM_METATADATA_FIELDS","name":"CUSTOM_METATADATA_FIELDS","value":"{} of Nil => Nil","doc":null,"summary":null}],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Plugins/AddMetadata","kind":"module","full_name":"Shrine::Plugins::AddMetadata","name":"AddMetadata"},"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[],"macros":[{"id":"add_metadata(name,decl)-macro","html_id":"add_metadata(name,decl)-macro","name":"add_metadata","doc":null,"summary":null,"abstract":false,"args":[{"name":"name","doc":null,"default_value":"","external_name":"name","restriction":""},{"name":"decl","doc":null,"default_value":"","external_name":"decl","restriction":""}],"args_string":"(name, decl)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/plugins/add_metadata.cr#L33","def":{"name":"add_metadata","args":[{"name":"name","doc":null,"default_value":"","external_name":"name","restriction":""},{"name":"decl","doc":null,"default_value":"","external_name":"decl","restriction":""}],"double_splat":null,"splat_index":null,"block_arg":null,"visibility":"Public","body":"          \n{% name = name.id\nCUSTOM_METATADATA_FIELDS[name] = decl\n %}\n\n        \n"}}],"types":[]}]},{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Plugins/DetermineMimeType","path":"Shrine/Plugins/DetermineMimeType.html","kind":"module","full_name":"Shrine::Plugins::DetermineMimeType","name":"DetermineMimeType","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"shrine/plugins/determine_mime_type.cr","line_number":5,"url":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/plugins/determine_mime_type.cr"}],"repository_name":"github.com/jetrockets/shrine.cr","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[{"id":"DEFAULT_OPTIONS","name":"DEFAULT_OPTIONS","value":"{analyzer: :file}","doc":null,"summary":null}],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Plugins","kind":"module","full_name":"Shrine::Plugins","name":"Plugins"},"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Plugins/DetermineMimeType/ClassMethods","path":"Shrine/Plugins/DetermineMimeType/ClassMethods.html","kind":"module","full_name":"Shrine::Plugins::DetermineMimeType::ClassMethods","name":"ClassMethods","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"shrine/plugins/determine_mime_type.cr","line_number":10,"url":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/plugins/determine_mime_type.cr"}],"repository_name":"github.com/jetrockets/shrine.cr","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Plugins/DetermineMimeType","kind":"module","full_name":"Shrine::Plugins::DetermineMimeType","name":"DetermineMimeType"},"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[{"id":"determine_mime_type(io)-instance-method","html_id":"determine_mime_type(io)-instance-method","name":"determine_mime_type","doc":"Determines the MIME type of the IO object by calling the specified\nanalyzer.","summary":"<p>Determines the MIME type of the IO object by calling the specified analyzer.</p>","abstract":false,"args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":""}],"args_string":"(io)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/plugins/determine_mime_type.cr#L13","def":{"name":"determine_mime_type","args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"config = plugin_settings.determine_mime_type\nanalyzer = mime_type_analyzer(config[:analyzer])\nmime_type = analyzer.call(io)\nio.rewind\nmime_type\n"}},{"id":"mime_type_analyzer(name:Tools)-instance-method","html_id":"mime_type_analyzer(name:Tools)-instance-method","name":"mime_type_analyzer","doc":"Returns callable mime type analyzer object.","summary":"<p>Returns callable mime type analyzer object.</p>","abstract":false,"args":[{"name":"name","doc":null,"default_value":"","external_name":"name","restriction":"Tools"}],"args_string":"(name : Tools)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/plugins/determine_mime_type.cr#L31","def":{"name":"mime_type_analyzer","args":[{"name":"name","doc":null,"default_value":"","external_name":"name","restriction":"Tools"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"MimeTypeAnalyzer.new(name)"}},{"id":"mime_type_analyzers-instance-method","html_id":"mime_type_analyzers-instance-method","name":"mime_type_analyzers","doc":"Returns a hash of built-in MIME type analyzers, where keys are\nanalyzer names and values are `#call`-able objects which accepts the\nIO object.","summary":"<p>Returns a hash of built-in MIME type analyzers, where keys are analyzer names and values are <code>#call</code>-able objects which accepts the IO object.</p>","abstract":false,"args":[],"args_string":"","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/plugins/determine_mime_type.cr#L26","def":{"name":"mime_type_analyzers","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"MimeTypeAnalyzer::Tools"}}],"macros":[],"types":[]},{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Plugins/DetermineMimeType/InstanceMethods","path":"Shrine/Plugins/DetermineMimeType/InstanceMethods.html","kind":"module","full_name":"Shrine::Plugins::DetermineMimeType::InstanceMethods","name":"InstanceMethods","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"shrine/plugins/determine_mime_type.cr","line_number":36,"url":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/plugins/determine_mime_type.cr"}],"repository_name":"github.com/jetrockets/shrine.cr","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Plugins/DetermineMimeType","kind":"module","full_name":"Shrine::Plugins::DetermineMimeType","name":"DetermineMimeType"},"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[]},{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Plugins/DetermineMimeType/MimeTypeAnalyzer","path":"Shrine/Plugins/DetermineMimeType/MimeTypeAnalyzer.html","kind":"class","full_name":"Shrine::Plugins::DetermineMimeType::MimeTypeAnalyzer","name":"MimeTypeAnalyzer","abstract":false,"superclass":{"html_id":"github.com/jetrockets/shrine.cr/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"github.com/jetrockets/shrine.cr/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"github.com/jetrockets/shrine.cr/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"shrine/plugins/determine_mime_type.cr","line_number":49,"url":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/plugins/determine_mime_type.cr"}],"repository_name":"github.com/jetrockets/shrine.cr","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Plugins/DetermineMimeType","kind":"module","full_name":"Shrine::Plugins::DetermineMimeType","name":"DetermineMimeType"},"doc":null,"summary":null,"class_methods":[],"constructors":[{"id":"new(tool:Tools)-class-method","html_id":"new(tool:Tools)-class-method","name":"new","doc":null,"summary":null,"abstract":false,"args":[{"name":"tool","doc":null,"default_value":"","external_name":"tool","restriction":"Tools"}],"args_string":"(tool : Tools)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/plugins/determine_mime_type.cr#L50","def":{"name":"new","args":[{"name":"tool","doc":null,"default_value":"","external_name":"tool","restriction":"Tools"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize(tool)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"id":"call(io,**options)-instance-method","html_id":"call(io,**options)-instance-method","name":"call","doc":null,"summary":null,"abstract":false,"args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":""}],"args_string":"(io, **options)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/plugins/determine_mime_type.cr#L53","def":{"name":"call","args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":""}],"double_splat":{"name":"options","doc":null,"default_value":"","external_name":"options","restriction":""},"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"mime_type = case @tool\nwhen Tools::File\n  extract_with_file(io, options)\nwhen Tools::Mime\n  extract_with_mime(io, options)\nwhen Tools::ContentType\n  extract_with_content_type(io, options)\nend\nio.rewind\nmime_type\n"}},{"id":"extract_filename(io)-instance-method","html_id":"extract_filename(io)-instance-method","name":"extract_filename","doc":null,"summary":null,"abstract":false,"args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":""}],"args_string":"(io)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/plugins/determine_mime_type.cr#L97","def":{"name":"extract_filename","args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"if io.responds_to?(:original_filename)\n  io.original_filename\nelse\n  if io.responds_to?(:path)\n    File.basename(io.path)\n  end\nend"}},{"id":"extract_with_content_type(io,options)-instance-method","html_id":"extract_with_content_type(io,options)-instance-method","name":"extract_with_content_type","doc":null,"summary":null,"abstract":false,"args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":""},{"name":"options","doc":null,"default_value":"","external_name":"options","restriction":""}],"args_string":"(io, options)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/plugins/determine_mime_type.cr#L91","def":{"name":"extract_with_content_type","args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":""},{"name":"options","doc":null,"default_value":"","external_name":"options","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"if (io.responds_to?(:content_type)) && io.content_type\n  (io.content_type.not_nil!.split(\";\")).first\nend"}}],"macros":[],"types":[]},{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Plugins/DetermineMimeType/Tools","path":"Shrine/Plugins/DetermineMimeType/Tools.html","kind":"enum","full_name":"Shrine::Plugins::DetermineMimeType::Tools","name":"Tools","abstract":false,"superclass":null,"ancestors":[{"html_id":"github.com/jetrockets/shrine.cr/Enum","kind":"struct","full_name":"Enum","name":"Enum"},{"html_id":"github.com/jetrockets/shrine.cr/Comparable","kind":"module","full_name":"Comparable","name":"Comparable"},{"html_id":"github.com/jetrockets/shrine.cr/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"github.com/jetrockets/shrine.cr/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"shrine/plugins/determine_mime_type.cr","line_number":43,"url":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/plugins/determine_mime_type.cr"}],"repository_name":"github.com/jetrockets/shrine.cr","program":false,"enum":true,"alias":false,"aliased":"","const":false,"constants":[{"id":"File","name":"File","value":"0","doc":null,"summary":null},{"id":"Mime","name":"Mime","value":"1","doc":null,"summary":null},{"id":"ContentType","name":"ContentType","value":"2","doc":null,"summary":null}],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Plugins/DetermineMimeType","kind":"module","full_name":"Shrine::Plugins::DetermineMimeType","name":"DetermineMimeType"},"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[{"id":"content_type?-instance-method","html_id":"content_type?-instance-method","name":"content_type?","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/plugins/determine_mime_type.cr#L46","def":{"name":"content_type?","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"self == ContentType"}},{"id":"file?-instance-method","html_id":"file?-instance-method","name":"file?","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/plugins/determine_mime_type.cr#L44","def":{"name":"file?","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"self == File"}},{"id":"mime?-instance-method","html_id":"mime?-instance-method","name":"mime?","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/plugins/determine_mime_type.cr#L45","def":{"name":"mime?","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"self == Mime"}}],"macros":[],"types":[]}]}]},{"html_id":"github.com/jetrockets/shrine.cr/Shrine/PluginSettings","path":"Shrine/PluginSettings.html","kind":"struct","full_name":"Shrine::PluginSettings","name":"PluginSettings","abstract":false,"superclass":{"html_id":"github.com/jetrockets/shrine.cr/Struct","kind":"struct","full_name":"Struct","name":"Struct"},"ancestors":[{"html_id":"github.com/jetrockets/shrine.cr/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"github.com/jetrockets/shrine.cr/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"github.com/jetrockets/shrine.cr/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"shrine.cr","line_number":30,"url":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine.cr"}],"repository_name":"github.com/jetrockets/shrine.cr","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/jetrockets/shrine.cr/Shrine","kind":"class","full_name":"Shrine","name":"Shrine"},"doc":null,"summary":null,"class_methods":[],"constructors":[{"id":"new-class-method","html_id":"new-class-method","name":"new","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine.cr#L30","def":{"name":"new","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"x = allocate\nif x.responds_to?(:finalize)\n  ::GC.add_finalizer(x)\nend\nx\n"}}],"instance_methods":[{"id":"all-instance-method","html_id":"all-instance-method","name":"all","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine.cr#L31","def":{"name":"all","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"[] of Nil"}}],"macros":[],"types":[]},{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Settings","path":"Shrine/Settings.html","kind":"class","full_name":"Shrine::Settings","name":"Settings","abstract":false,"superclass":{"html_id":"github.com/jetrockets/shrine.cr/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"github.com/jetrockets/shrine.cr/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"github.com/jetrockets/shrine.cr/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"shrine.cr","line_number":25,"url":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine.cr"}],"repository_name":"github.com/jetrockets/shrine.cr","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/jetrockets/shrine.cr/Shrine","kind":"class","full_name":"Shrine","name":"Shrine"},"doc":null,"summary":null,"class_methods":[{"id":"log_level-class-method","html_id":"log_level-class-method","name":"log_level","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":null,"def":{"name":"log_level","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@@log_level.not_nil!"}},{"id":"log_level=(value:Logger::Severity)-class-method","html_id":"log_level=(value:Logger::Severity)-class-method","name":"log_level=","doc":null,"summary":null,"abstract":false,"args":[{"name":"value","doc":null,"default_value":"","external_name":"value","restriction":"Logger::Severity"}],"args_string":"(value : Logger::Severity)","source_link":null,"def":{"name":"log_level=","args":[{"name":"value","doc":null,"default_value":"","external_name":"value","restriction":"Logger::Severity"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@@log_level = value"}},{"id":"log_level?-class-method","html_id":"log_level?-class-method","name":"log_level?","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":null,"def":{"name":"log_level?","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@@log_level"}},{"id":"storages-class-method","html_id":"storages-class-method","name":"storages","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":null,"def":{"name":"storages","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@@storages.not_nil!"}},{"id":"storages=(value:Hash(String,Storage::Base))-class-method","html_id":"storages=(value:Hash(String,Storage::Base))-class-method","name":"storages=","doc":null,"summary":null,"abstract":false,"args":[{"name":"value","doc":null,"default_value":"","external_name":"value","restriction":"Hash(String, Storage::Base)"}],"args_string":"(value : Hash(String, Storage::Base))","source_link":null,"def":{"name":"storages=","args":[{"name":"value","doc":null,"default_value":"","external_name":"value","restriction":"Hash(String, Storage::Base)"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@@storages = value"}},{"id":"storages?-class-method","html_id":"storages?-class-method","name":"storages?","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":null,"def":{"name":"storages?","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@@storages"}}],"constructors":[],"instance_methods":[],"macros":[],"types":[]},{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Storage","path":"Shrine/Storage.html","kind":"module","full_name":"Shrine::Storage","name":"Storage","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"shrine/storage/base.cr","line_number":4,"url":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/base.cr"},{"filename":"shrine/storage/file_system.cr","line_number":4,"url":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/file_system.cr"},{"filename":"shrine/storage/memory.cr","line_number":4,"url":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/memory.cr"},{"filename":"shrine/storage/s3.cr","line_number":6,"url":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/s3.cr"}],"repository_name":"github.com/jetrockets/shrine.cr","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/jetrockets/shrine.cr/Shrine","kind":"class","full_name":"Shrine","name":"Shrine"},"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Storage/Base","path":"Shrine/Storage/Base.html","kind":"class","full_name":"Shrine::Storage::Base","name":"Base","abstract":true,"superclass":{"html_id":"github.com/jetrockets/shrine.cr/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"github.com/jetrockets/shrine.cr/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"github.com/jetrockets/shrine.cr/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"shrine/storage/base.cr","line_number":5,"url":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/base.cr"}],"repository_name":"github.com/jetrockets/shrine.cr","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Storage/FileSystem","kind":"class","full_name":"Shrine::Storage::FileSystem","name":"FileSystem"},{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Storage/Memory","kind":"class","full_name":"Shrine::Storage::Memory","name":"Memory"},{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Storage/S3","kind":"class","full_name":"Shrine::Storage::S3","name":"S3"}],"including_types":[],"namespace":{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Storage","kind":"module","full_name":"Shrine::Storage","name":"Storage"},"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[{"id":"clean(path:String)-instance-method","html_id":"clean(path:String)-instance-method","name":"clean","doc":"cleans the path in the storage","summary":"<p>cleans the path in the storage</p>","abstract":true,"args":[{"name":"path","doc":null,"default_value":"","external_name":"path","restriction":"String"}],"args_string":"(path : String)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/base.cr#L24","def":{"name":"clean","args":[{"name":"path","doc":null,"default_value":"","external_name":"path","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":""}},{"id":"clean?:Bool-instance-method","html_id":"clean?:Bool-instance-method","name":"clean?","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Bool","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/base.cr#L6","def":{"name":"clean?","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Bool","visibility":"Public","body":"@clean"}},{"id":"delete(id:String)-instance-method","html_id":"delete(id:String)-instance-method","name":"delete","doc":"deletes the file from the storage","summary":"<p>deletes the file from the storage</p>","abstract":true,"args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"args_string":"(id : String)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/base.cr#L21","def":{"name":"delete","args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":""}},{"id":"exists?(id:String):Bool-instance-method","html_id":"exists?(id:String):Bool-instance-method","name":"exists?","doc":"returns whether the file exists on storage","summary":"<p>returns whether the file exists on storage</p>","abstract":true,"args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"args_string":"(id : String) : Bool","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/base.cr#L18","def":{"name":"exists?","args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Bool","visibility":"Public","body":""}},{"id":"open(id:String,**options):IO-instance-method","html_id":"open(id:String,**options):IO-instance-method","name":"open","doc":"returns the remote file as an IO-like object","summary":"<p>returns the remote file as an IO-like object</p>","abstract":true,"args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"args_string":"(id : String, **options) : IO","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/base.cr#L12","def":{"name":"open","args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"double_splat":{"name":"options","doc":null,"default_value":"","external_name":"options","restriction":""},"splat_index":null,"yields":null,"block_arg":null,"return_type":"IO","visibility":"Public","body":""}},{"id":"upload(io:IO,id:String,move=false,**options)-instance-method","html_id":"upload(io:IO,id:String,move=false,**options)-instance-method","name":"upload","doc":"uploads `io` to the location `id`, can accept upload options","summary":"<p>uploads <code>io</code> to the location <code>id</code>, can accept upload options</p>","abstract":true,"args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":"IO"},{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"},{"name":"move","doc":null,"default_value":"false","external_name":"move","restriction":""}],"args_string":"(io : IO, id : String, move = <span class=\"n\">false</span>, **options)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/base.cr#L9","def":{"name":"upload","args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":"IO"},{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"},{"name":"move","doc":null,"default_value":"false","external_name":"move","restriction":""}],"double_splat":{"name":"options","doc":null,"default_value":"","external_name":"options","restriction":""},"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":""}},{"id":"url(id:String,**options):String-instance-method","html_id":"url(id:String,**options):String-instance-method","name":"url","doc":"returns URL to the remote file, can accept URL options","summary":"<p>returns URL to the remote file, can accept URL options</p>","abstract":true,"args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"args_string":"(id : String, **options) : String","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/base.cr#L15","def":{"name":"url","args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"double_splat":{"name":"options","doc":null,"default_value":"","external_name":"options","restriction":""},"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":""}}],"macros":[],"types":[]},{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Storage/FileSystem","path":"Shrine/Storage/FileSystem.html","kind":"class","full_name":"Shrine::Storage::FileSystem","name":"FileSystem","abstract":false,"superclass":{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Storage/Base","kind":"class","full_name":"Shrine::Storage::Base","name":"Base"},"ancestors":[{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Storage/Base","kind":"class","full_name":"Shrine::Storage::Base","name":"Base"},{"html_id":"github.com/jetrockets/shrine.cr/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"github.com/jetrockets/shrine.cr/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"shrine/storage/file_system.cr","line_number":5,"url":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/file_system.cr"}],"repository_name":"github.com/jetrockets/shrine.cr","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[{"id":"DEFAULT_DIRECTORY_PERMISSIONS","name":"DEFAULT_DIRECTORY_PERMISSIONS","value":"493","doc":null,"summary":null},{"id":"DEFAULT_PERMISSIONS","name":"DEFAULT_PERMISSIONS","value":"420","doc":null,"summary":null}],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Storage","kind":"module","full_name":"Shrine::Storage","name":"Storage"},"doc":null,"summary":null,"class_methods":[],"constructors":[{"id":"new(directory:String,prefix:String?=nil,clean=true,permissions:Int=DEFAULT_PERMISSIONS,directory_permissions:Int=DEFAULT_DIRECTORY_PERMISSIONS)-class-method","html_id":"new(directory:String,prefix:String?=nil,clean=true,permissions:Int=DEFAULT_PERMISSIONS,directory_permissions:Int=DEFAULT_DIRECTORY_PERMISSIONS)-class-method","name":"new","doc":"Initializes a storage for uploading to the filesystem.\n\n:prefix\n:  The directory relative to `directory` to which files will be stored,\n   and it is included in the URL.\n\n:permissions\n:  The UNIX permissions applied to created files. Can be set to `nil`,\n   in which case the default permissions will be applied. Defaults to\n   `0644`.\n\n:directory_permissions\n:  The UNIX permissions applied to created directories. Can be set to\n   `nil`, in which case the default permissions will be applied. Defaults\n   to `0755`.\n\n:clean\n:  By default empty folders inside the directory are automatically\n   deleted, but if it happens that it causes too much load on the\n   filesystem, you can set this option to `false`.","summary":"<p>Initializes a storage for uploading to the filesystem.</p>","abstract":false,"args":[{"name":"directory","doc":null,"default_value":"","external_name":"directory","restriction":"String"},{"name":"prefix","doc":null,"default_value":"nil","external_name":"prefix","restriction":"String | ::Nil"},{"name":"clean","doc":null,"default_value":"true","external_name":"clean","restriction":""},{"name":"permissions","doc":null,"default_value":"DEFAULT_PERMISSIONS","external_name":"permissions","restriction":"Int"},{"name":"directory_permissions","doc":null,"default_value":"DEFAULT_DIRECTORY_PERMISSIONS","external_name":"directory_permissions","restriction":"Int"}],"args_string":"(directory : String, prefix : String? = <span class=\"n\">nil</span>, clean = <span class=\"n\">true</span>, permissions : Int = <span class=\"t\">DEFAULT_PERMISSIONS</span>, directory_permissions : Int = <span class=\"t\">DEFAULT_DIRECTORY_PERMISSIONS</span>)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/file_system.cr#L42","def":{"name":"new","args":[{"name":"directory","doc":null,"default_value":"","external_name":"directory","restriction":"String"},{"name":"prefix","doc":null,"default_value":"nil","external_name":"prefix","restriction":"String | ::Nil"},{"name":"clean","doc":null,"default_value":"true","external_name":"clean","restriction":""},{"name":"permissions","doc":null,"default_value":"DEFAULT_PERMISSIONS","external_name":"permissions","restriction":"Int"},{"name":"directory_permissions","doc":null,"default_value":"DEFAULT_DIRECTORY_PERMISSIONS","external_name":"directory_permissions","restriction":"Int"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize(directory, prefix, clean, permissions, directory_permissions)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"id":"delete(id:String)-instance-method","html_id":"delete(id:String)-instance-method","name":"delete","doc":"Deletes the file, and by default deletes the containing directory if\nit's empty.","summary":"<p>Deletes the file, and by default deletes the containing directory if it's empty.</p>","abstract":false,"args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"args_string":"(id : String)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/file_system.cr#L89","def":{"name":"delete","args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"path = path(id)\nFile.delete(path)\nif clean?\n  clean(path)\nend\n"}},{"id":"directory:String-instance-method","html_id":"directory:String-instance-method","name":"directory","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : String","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/file_system.cr#L6","def":{"name":"directory","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"@directory"}},{"id":"directory_permissions:Int32-instance-method","html_id":"directory_permissions:Int32-instance-method","name":"directory_permissions","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Int32","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/file_system.cr#L9","def":{"name":"directory_permissions","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@directory_permissions"}},{"id":"exists?(id:String):Bool-instance-method","html_id":"exists?(id:String):Bool-instance-method","name":"exists?","doc":"Returns true if the file exists on the filesystem.","summary":"<p>Returns true if the file exists on the filesystem.</p>","abstract":false,"args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"args_string":"(id : String) : Bool","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/file_system.cr#L67","def":{"name":"exists?","args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Bool","visibility":"Public","body":"File.exists?(path(id))"}},{"id":"expanded_directory:String-instance-method","html_id":"expanded_directory:String-instance-method","name":"expanded_directory","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : String","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/file_system.cr#L14","def":{"name":"expanded_directory","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"if relative_prefix\n  File.expand_path(File.join(directory, relative_prefix.not_nil!))\nelse\n  File.expand_path(directory)\nend"}},{"id":"open(id:String,**options):File-instance-method","html_id":"open(id:String,**options):File-instance-method","name":"open","doc":"Opens the file on the given location in read mode. Accepts additional\n`File.open` arguments.","summary":"<p>Opens the file on the given location in read mode.</p>","abstract":false,"args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"args_string":"(id : String, **options) : File","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/file_system.cr#L59","def":{"name":"open","args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"double_splat":{"name":"options","doc":null,"default_value":"","external_name":"options","restriction":""},"splat_index":null,"yields":null,"block_arg":null,"return_type":"File","visibility":"Public","body":"begin\n  File.open(path(id), mode: \"rb\")\nrescue Errno\n  raise(Shrine::FileNotFound.new(\"file #{id.inspect} not found on storage\"))\nend"}},{"id":"path(id:String):String-instance-method","html_id":"path(id:String):String-instance-method","name":"path","doc":"Returns the full path to the file.","summary":"<p>Returns the full path to the file.</p>","abstract":false,"args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"args_string":"(id : String) : String","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/file_system.cr#L72","def":{"name":"path","args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"File.join(expanded_directory, id.gsub(\"/\", File::SEPARATOR))"}},{"id":"permissions:Int32-instance-method","html_id":"permissions:Int32-instance-method","name":"permissions","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Int32","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/file_system.cr#L8","def":{"name":"permissions","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@permissions"}},{"id":"prefix:String?-instance-method","html_id":"prefix:String?-instance-method","name":"prefix","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : String?","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/file_system.cr#L7","def":{"name":"prefix","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"String | ::Nil","visibility":"Public","body":"@prefix"}},{"id":"upload(io:IO,id:String,move=false,**options)-instance-method","html_id":"upload(io:IO,id:String,move=false,**options)-instance-method","name":"upload","doc":"Copies the file into the given location.","summary":"<p>Copies the file into the given location.</p>","abstract":false,"args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":"IO"},{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"},{"name":"move","doc":null,"default_value":"false","external_name":"move","restriction":""}],"args_string":"(io : IO, id : String, move = <span class=\"n\">false</span>, **options)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/file_system.cr#L49","def":{"name":"upload","args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":"IO"},{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"},{"name":"move","doc":null,"default_value":"false","external_name":"move","restriction":""}],"double_splat":{"name":"options","doc":null,"default_value":"","external_name":"options","restriction":""},"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"if move && (movable?(io))\n  move(io, path!(id))\nelse\n  File.write(path!(id), content: io, perm: permissions)\nend"}},{"id":"url(id:String,host:String?=nil,**options):String-instance-method","html_id":"url(id:String,host:String?=nil,**options):String-instance-method","name":"url","doc":"If #relative_prefix is not present, returns a path composed of #directory and\nthe given `id`. If #relative_prefix is present, it excludes the #directory part\nfrom the returned path (e.g. #directory can be set to \"public\" folder).\nBoth cases accept a `:host` value which will be prefixed to the\ngenerated path.\ndef url(id, host : String? = nil, **options)","summary":"<p>If #relative_prefix is not present, returns a path composed of #directory and the given <code>id</code>.</p>","abstract":false,"args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"},{"name":"host","doc":null,"default_value":"nil","external_name":"host","restriction":"String | ::Nil"}],"args_string":"(id : String, host : String? = <span class=\"n\">nil</span>, **options) : String","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/file_system.cr#L82","def":{"name":"url","args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"},{"name":"host","doc":null,"default_value":"nil","external_name":"host","restriction":"String | ::Nil"}],"double_splat":{"name":"options","doc":null,"default_value":"","external_name":"options","restriction":""},"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"path = (relative_prefix ? relative_path(id) : path(id)).to_s\nhost ? host + path : path\n"}}],"macros":[],"types":[]},{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Storage/Memory","path":"Shrine/Storage/Memory.html","kind":"class","full_name":"Shrine::Storage::Memory","name":"Memory","abstract":false,"superclass":{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Storage/Base","kind":"class","full_name":"Shrine::Storage::Base","name":"Base"},"ancestors":[{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Storage/Base","kind":"class","full_name":"Shrine::Storage::Base","name":"Base"},{"html_id":"github.com/jetrockets/shrine.cr/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"github.com/jetrockets/shrine.cr/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"shrine/storage/memory.cr","line_number":5,"url":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/memory.cr"}],"repository_name":"github.com/jetrockets/shrine.cr","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Storage","kind":"module","full_name":"Shrine::Storage","name":"Storage"},"doc":null,"summary":null,"class_methods":[],"constructors":[{"id":"new-class-method","html_id":"new-class-method","name":"new","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/memory.cr#L8","def":{"name":"new","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"id":"clear!-instance-method","html_id":"clear!-instance-method","name":"clear!","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/memory.cr#L44","def":{"name":"clear!","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"store.clear"}},{"id":"delete(id:String)-instance-method","html_id":"delete(id:String)-instance-method","name":"delete","doc":"deletes the file from the storage","summary":"<p>deletes the file from the storage</p>","abstract":false,"args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"args_string":"(id : String)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/memory.cr#L35","def":{"name":"delete","args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"store.delete(id)"}},{"id":"delete_prefixed(delete_prefix:String)-instance-method","html_id":"delete_prefixed(delete_prefix:String)-instance-method","name":"delete_prefixed","doc":null,"summary":null,"abstract":false,"args":[{"name":"delete_prefix","doc":null,"default_value":"","external_name":"delete_prefix","restriction":"String"}],"args_string":"(delete_prefix : String)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/memory.cr#L39","def":{"name":"delete_prefixed","args":[{"name":"delete_prefix","doc":null,"default_value":"","external_name":"delete_prefix","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"delete_prefix = (delete_prefix.chomp(\"/\")) + \"/\"\nstore.delete_if do |key, _value|\n  key.start_with?(delete_prefix)\nend\n"}},{"id":"exists?(id:String):Bool-instance-method","html_id":"exists?(id:String):Bool-instance-method","name":"exists?","doc":"returns whether the file exists on storage","summary":"<p>returns whether the file exists on storage</p>","abstract":false,"args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"args_string":"(id : String) : Bool","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/memory.cr#L23","def":{"name":"exists?","args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Bool","visibility":"Public","body":"store.has_key?(id)"}},{"id":"open(id:String):IO-instance-method","html_id":"open(id:String):IO-instance-method","name":"open","doc":"returns the remote file as an IO-like object","summary":"<p>returns the remote file as an IO-like object</p>","abstract":false,"args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"args_string":"(id : String) : IO","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/memory.cr#L16","def":{"name":"open","args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"IO","visibility":"Public","body":"begin\n  IO::Memory.new(store[id])\nrescue KeyError\n  raise(Shrine::FileNotFound.new(\"file #{id.inspect} not found on storage\"))\nend"}},{"id":"path(id:String):String-instance-method","html_id":"path(id:String):String-instance-method","name":"path","doc":null,"summary":null,"abstract":false,"args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"args_string":"(id : String) : String","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/memory.cr#L31","def":{"name":"path","args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"id"}},{"id":"store:Hash(String,String)-instance-method","html_id":"store:Hash(String,String)-instance-method","name":"store","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Hash(String, String)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/memory.cr#L6","def":{"name":"store","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@store"}},{"id":"upload(io:IO,id:String,**options)-instance-method","html_id":"upload(io:IO,id:String,**options)-instance-method","name":"upload","doc":"uploads `io` to the location `id`, can accept upload options","summary":"<p>uploads <code>io</code> to the location <code>id</code>, can accept upload options</p>","abstract":false,"args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":"IO"},{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"args_string":"(io : IO, id : String, **options)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/memory.cr#L12","def":{"name":"upload","args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":"IO"},{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"double_splat":{"name":"options","doc":null,"default_value":"","external_name":"options","restriction":""},"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"store[id.to_s] = io.gets_to_end"}},{"id":"url(id:String,**options):String-instance-method","html_id":"url(id:String,**options):String-instance-method","name":"url","doc":"returns URL to the remote file, can accept URL options","summary":"<p>returns URL to the remote file, can accept URL options</p>","abstract":false,"args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"args_string":"(id : String, **options) : String","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/memory.cr#L27","def":{"name":"url","args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"double_splat":{"name":"options","doc":null,"default_value":"","external_name":"options","restriction":""},"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"\"memory://#{path(id)}\""}}],"macros":[],"types":[]},{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Storage/S3","path":"Shrine/Storage/S3.html","kind":"class","full_name":"Shrine::Storage::S3","name":"S3","abstract":false,"superclass":{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Storage/Base","kind":"class","full_name":"Shrine::Storage::Base","name":"Base"},"ancestors":[{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Storage/Base","kind":"class","full_name":"Shrine::Storage::Base","name":"Base"},{"html_id":"github.com/jetrockets/shrine.cr/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"github.com/jetrockets/shrine.cr/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"shrine/storage/s3.cr","line_number":7,"url":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/s3.cr"}],"repository_name":"github.com/jetrockets/shrine.cr","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/jetrockets/shrine.cr/Shrine/Storage","kind":"module","full_name":"Shrine::Storage","name":"Storage"},"doc":null,"summary":null,"class_methods":[],"constructors":[{"id":"new(bucket:String,client:Awscr::S3::Client?,prefix:String?=nil,upload_options:Hash(String,String)=Hash(String,String).new,public:Bool=false)-class-method","html_id":"new(bucket:String,client:Awscr::S3::Client?,prefix:String?=nil,upload_options:Hash(String,String)=Hash(String,String).new,public:Bool=false)-class-method","name":"new","doc":"Initializes a storage for uploading to S3. All options are forwarded to\n[`Shrine::Storage::S3#initialize`], except the following:\n\n:bucket\n: (Required). Name of the S3 bucket.\n\n:client\n: By default an `Awscr::S3::Client` instance is created internally from\n  additional options, but you can use this option to provide your own\n  client.\n\n:prefix\n: \"Directory\" inside the bucket to store files into.\n\n:upload_options\n: Additional options that will be used for uploading files.\n\n:public\n: Sets public access to all uploading files.\n","summary":"<p>Initializes a storage for uploading to S3.</p>","abstract":false,"args":[{"name":"bucket","doc":null,"default_value":"","external_name":"bucket","restriction":"String"},{"name":"client","doc":null,"default_value":"","external_name":"client","restriction":"Awscr::S3::Client | ::Nil"},{"name":"prefix","doc":null,"default_value":"nil","external_name":"prefix","restriction":"String | ::Nil"},{"name":"upload_options","doc":null,"default_value":"Hash(String, String).new","external_name":"upload_options","restriction":"Hash(String, String)"},{"name":"public","doc":null,"default_value":"false","external_name":"public","restriction":"Bool"}],"args_string":"(bucket : String, client : Awscr::S3::Client?, prefix : String? = <span class=\"n\">nil</span>, upload_options : Hash(String, String) = <span class=\"t\">Hash</span>(<span class=\"t\">String</span>, <span class=\"t\">String</span>).<span class=\"k\">new</span>, public : Bool = <span class=\"n\">false</span>)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/s3.cr#L32","def":{"name":"new","args":[{"name":"bucket","doc":null,"default_value":"","external_name":"bucket","restriction":"String"},{"name":"client","doc":null,"default_value":"","external_name":"client","restriction":"Awscr::S3::Client | ::Nil"},{"name":"prefix","doc":null,"default_value":"nil","external_name":"prefix","restriction":"String | ::Nil"},{"name":"upload_options","doc":null,"default_value":"Hash(String, String).new","external_name":"upload_options","restriction":"Hash(String, String)"},{"name":"public","doc":null,"default_value":"false","external_name":"public","restriction":"Bool"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize(bucket, client, prefix, upload_options, public)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"id":"bucket:String-instance-method","html_id":"bucket:String-instance-method","name":"bucket","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : String","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/s3.cr#L8","def":{"name":"bucket","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"@bucket"}},{"id":"clean(path)-instance-method","html_id":"clean(path)-instance-method","name":"clean","doc":null,"summary":null,"abstract":false,"args":[{"name":"path","doc":null,"default_value":"","external_name":"path","restriction":""}],"args_string":"(path)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/s3.cr#L86","def":{"name":"clean","args":[{"name":"path","doc":null,"default_value":"","external_name":"path","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":""}},{"id":"client:Awscr::S3::Client-instance-method","html_id":"client:Awscr::S3::Client-instance-method","name":"client","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Awscr::S3::Client","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/s3.cr#L9","def":{"name":"client","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Awscr::S3::Client","visibility":"Public","body":"@client"}},{"id":"delete(id:String):Bool-instance-method","html_id":"delete(id:String):Bool-instance-method","name":"delete","doc":"Delets the file, and by default deletes the containing directory if\nit's empty.","summary":"<p>Delets the file, and by default deletes the containing directory if it's empty.</p>","abstract":false,"args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"args_string":"(id : String) : Bool","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/s3.cr#L82","def":{"name":"delete","args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Bool","visibility":"Public","body":"client.delete_object(bucket, object_key(id))"}},{"id":"exists?(id:String):Bool-instance-method","html_id":"exists?(id:String):Bool-instance-method","name":"exists?","doc":"Returns true if the file exists on the S3.","summary":"<p>Returns true if the file exists on the S3.</p>","abstract":false,"args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"args_string":"(id : String) : Bool","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/s3.cr#L73","def":{"name":"exists?","args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Bool","visibility":"Public","body":"begin\n  client.head_object(bucket, object: object_key(id))\n  true\nrescue Awscr::S3::Exception\n  false\nend"}},{"id":"object_key(id:String):String-instance-method","html_id":"object_key(id:String):String-instance-method","name":"object_key","doc":"Returns object key with potential prefix.","summary":"<p>Returns object key with potential prefix.</p>","abstract":false,"args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"args_string":"(id : String) : String","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/s3.cr#L90","def":{"name":"object_key","args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"@prefix ? [@prefix, id].join(\"/\") : id"}},{"id":"open(id:String,**options):IO-instance-method","html_id":"open(id:String,**options):IO-instance-method","name":"open","doc":"Returns a IO object from S3","summary":"<p>Returns a IO object from S3</p>","abstract":false,"args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"args_string":"(id : String, **options) : IO","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/s3.cr#L51","def":{"name":"open","args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"double_splat":{"name":"options","doc":null,"default_value":"","external_name":"options","restriction":""},"splat_index":null,"yields":null,"block_arg":null,"return_type":"IO","visibility":"Public","body":"io = IO::Memory.new\nclient.get_object(bucket, object_key(id)) do |obj|\n  io << obj\nend\n"}},{"id":"public?:Bool-instance-method","html_id":"public?:Bool-instance-method","name":"public?","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Bool","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/s3.cr#L10","def":{"name":"public?","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Bool","visibility":"Public","body":"@public"}},{"id":"upload(io:IO,id:String,metadata:Shrine::UploadedFile::MetadataType?=nil,move=false,**upload_options)-instance-method","html_id":"upload(io:IO,id:String,metadata:Shrine::UploadedFile::MetadataType?=nil,move=false,**upload_options)-instance-method","name":"upload","doc":"Copies the file into the given location.","summary":"<p>Copies the file into the given location.</p>","abstract":false,"args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":"IO"},{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"},{"name":"metadata","doc":null,"default_value":"nil","external_name":"metadata","restriction":"Shrine::UploadedFile::MetadataType | ::Nil"},{"name":"move","doc":null,"default_value":"false","external_name":"move","restriction":""}],"args_string":"(io : IO, id : String, metadata : Shrine::UploadedFile::MetadataType? = <span class=\"n\">nil</span>, move = <span class=\"n\">false</span>, **upload_options)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/s3.cr#L37","def":{"name":"upload","args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":"IO"},{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"},{"name":"metadata","doc":null,"default_value":"nil","external_name":"metadata","restriction":"Shrine::UploadedFile::MetadataType | ::Nil"},{"name":"move","doc":null,"default_value":"false","external_name":"move","restriction":""}],"double_splat":{"name":"upload_options","doc":null,"default_value":"","external_name":"upload_options","restriction":""},"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"options = Hash(String, String).new\nif public?\n  options[\"x-amz-acl\"] = \"public-read\"\nend\nuploader = Awscr::S3::FileUploader.new(client)\nupload_options = upload_options.map do |k, v|\n  {k.to_s => v.to_s}\nend\nupload_options.each do |item|\n  options.merge!(item)\nend\nif @upload_options\n  options.merge!(@upload_options)\nend\nuploader.upload(bucket, object_key(id), io, options)\n"}},{"id":"url(id:String,**options):String-instance-method","html_id":"url(id:String,**options):String-instance-method","name":"url","doc":"Returns the presigned URL to the file.","summary":"<p>Returns the presigned URL to the file.</p>","abstract":false,"args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"args_string":"(id : String, **options) : String","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/storage/s3.cr#L59","def":{"name":"url","args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"}],"double_splat":{"name":"options","doc":null,"default_value":"","external_name":"options","restriction":""},"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"presigned_options = Awscr::S3::Presigned::Url::Options.new(aws_access_key: client.@aws_access_key, aws_secret_key: client.@aws_secret_key, region: client.@region, object: \"/#{object_key(id)}\", bucket: bucket)\nurl = Awscr::S3::Presigned::Url.new(presigned_options)\nurl.for(:get)\n"}}],"macros":[],"types":[]}]},{"html_id":"github.com/jetrockets/shrine.cr/Shrine/UploadedFile","path":"Shrine/UploadedFile.html","kind":"class","full_name":"Shrine::UploadedFile","name":"UploadedFile","abstract":false,"superclass":{"html_id":"github.com/jetrockets/shrine.cr/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"github.com/jetrockets/shrine.cr/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"github.com/jetrockets/shrine.cr/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"shrine/uploaded_file.cr","line_number":4,"url":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/uploaded_file.cr"}],"repository_name":"github.com/jetrockets/shrine.cr","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/jetrockets/shrine.cr/Shrine","kind":"class","full_name":"Shrine","name":"Shrine"},"doc":null,"summary":null,"class_methods":[],"constructors":[{"id":"new(id:String,storage:String,metadata:MetadataType=MetadataType.new)-class-method","html_id":"new(id:String,storage:String,metadata:MetadataType=MetadataType.new)-class-method","name":"new","doc":null,"summary":null,"abstract":false,"args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"},{"name":"storage","doc":null,"default_value":"","external_name":"storage","restriction":"String"},{"name":"metadata","doc":null,"default_value":"MetadataType.new","external_name":"metadata","restriction":"MetadataType"}],"args_string":"(id : String, storage : String, metadata : MetadataType = <span class=\"t\">MetadataType</span>.<span class=\"k\">new</span>)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/uploaded_file.cr#L26","def":{"name":"new","args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"},{"name":"storage","doc":null,"default_value":"","external_name":"storage","restriction":"String"},{"name":"metadata","doc":null,"default_value":"MetadataType.new","external_name":"metadata","restriction":"MetadataType"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize(id, storage, metadata)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}},{"id":"new(id:String,storage:Symbol,metadata:MetadataType=MetadataType.new)-class-method","html_id":"new(id:String,storage:Symbol,metadata:MetadataType=MetadataType.new)-class-method","name":"new","doc":null,"summary":null,"abstract":false,"args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"},{"name":"storage","doc":null,"default_value":"","external_name":"storage","restriction":"Symbol"},{"name":"metadata","doc":null,"default_value":"MetadataType.new","external_name":"metadata","restriction":"MetadataType"}],"args_string":"(id : String, storage : Symbol, metadata : MetadataType = <span class=\"t\">MetadataType</span>.<span class=\"k\">new</span>)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/uploaded_file.cr#L33","def":{"name":"new","args":[{"name":"id","doc":null,"default_value":"","external_name":"id","restriction":"String"},{"name":"storage","doc":null,"default_value":"","external_name":"storage","restriction":"Symbol"},{"name":"metadata","doc":null,"default_value":"MetadataType.new","external_name":"metadata","restriction":"MetadataType"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize(id, storage, metadata)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}},{"id":"new(__temp_84:JSON::PullParser)-class-method","html_id":"new(__temp_84:JSON::PullParser)-class-method","name":"new","doc":null,"summary":null,"abstract":false,"args":[{"name":"__temp_84","doc":null,"default_value":"","external_name":"__temp_84","restriction":"::JSON::PullParser"}],"args_string":"(__temp_84 : JSON::PullParser)","source_link":null,"def":{"name":"new","args":[{"name":"__temp_84","doc":null,"default_value":"","external_name":"__temp_84","restriction":"::JSON::PullParser"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize(__temp_84)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"id":"[](key)-instance-method","html_id":"[](key)-instance-method","name":"[]","doc":"Shorthand for accessing metadata values.","summary":"<p>Shorthand for accessing metadata values.</p>","abstract":false,"args":[{"name":"key","doc":null,"default_value":"","external_name":"key","restriction":""}],"args_string":"(key)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/uploaded_file.cr#L67","def":{"name":"[]","args":[{"name":"key","doc":null,"default_value":"","external_name":"key","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"metadata[key]?"}},{"id":"close-instance-method","html_id":"close-instance-method","name":"close","doc":"Part of complying to the IO interface. It delegates to the internally\nopened IO object.","summary":"<p>Part of complying to the IO interface.</p>","abstract":false,"args":[],"args_string":"","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/uploaded_file.cr#L160","def":{"name":"close","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"if opened?\n  io.close\nend"}},{"id":"content_type-instance-method","html_id":"content_type-instance-method","name":"content_type","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/uploaded_file.cr#L58","def":{"name":"content_type","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"mime_type"}},{"id":"data:Hash(String,String|MetadataType)-instance-method","html_id":"data:Hash(String,String|MetadataType)-instance-method","name":"data","doc":"Returns serializable hash representation of the uploaded file.","summary":"<p>Returns serializable hash representation of the uploaded file.</p>","abstract":false,"args":[],"args_string":" : Hash(String, String | MetadataType)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/uploaded_file.cr#L206","def":{"name":"data","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Hash(String, String | MetadataType)","visibility":"Public","body":"{\"id\" => id, \"storage\" => storage_key, \"metadata\" => metadata}"}},{"id":"delete-instance-method","html_id":"delete-instance-method","name":"delete","doc":"Calls `#delete` on the storage, which deletes the file from the\nstorage.","summary":"<p>Calls <code><a href=\"../Shrine/UploadedFile.html#delete-instance-method\">#delete</a></code> on the storage, which deletes the file from the storage.</p>","abstract":false,"args":[],"args_string":"","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/uploaded_file.cr#L187","def":{"name":"delete","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"storage.delete(id)"}},{"id":"download(**options,&)-instance-method","html_id":"download(**options,&amp;)-instance-method","name":"download","doc":"Streams content into a newly created tempfile, yields it to the\nblock, and at the end of the block automatically closes it.\nIn this case the return value of the method is the block\nreturn value.\n\n```\nuploaded_file.download { |tempfile| tempfile.gets_to_end } # tempfile is deleted\n```\n","summary":"<p>Streams content into a newly created tempfile, yields it to the block, and at the end of the block automatically closes it.</p>","abstract":false,"args":[],"args_string":"(**options, &)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/uploaded_file.cr#L129","def":{"name":"download","args":[],"double_splat":{"name":"options","doc":null,"default_value":"","external_name":"options","restriction":""},"splat_index":null,"yields":1,"block_arg":null,"return_type":"","visibility":"Public","body":"begin\n  tempfile = download(**options)\n  yield tempfile\nensure\n  if tempfile\n    tempfile.not_nil!.close\n    tempfile.not_nil!.delete\n  end\nend"}},{"id":"download(**options)-instance-method","html_id":"download(**options)-instance-method","name":"download","doc":"Streams content into a newly created tempfile and returns it.\n\n```\nuploaded_file.download\n# => #<File:/var/folders/.../20180302-33119-1h1vjbq.jpg>\n```\n","summary":"<p>Streams content into a newly created tempfile and returns it.</p>","abstract":false,"args":[],"args_string":"(**options)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/uploaded_file.cr#L114","def":{"name":"download","args":[],"double_splat":{"name":"options","doc":null,"default_value":"","external_name":"options","restriction":""},"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"tempfile = File.tempfile(\"shrine\", \".#{extension}\")\nstream(tempfile, **options)\ntempfile.rewind\n"}},{"id":"exists?-instance-method","html_id":"exists?-instance-method","name":"exists?","doc":"Calls `#exists?` on the storage, which checks whether the file exists\non the storage.","summary":"<p>Calls <code><a href=\"../Shrine/UploadedFile.html#exists?-instance-method\">#exists?</a></code> on the storage, which checks whether the file exists on the storage.</p>","abstract":false,"args":[],"args_string":"","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/uploaded_file.cr#L176","def":{"name":"exists?","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"storage.exists?(id)"}},{"id":"extension-instance-method","html_id":"extension-instance-method","name":"extension","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/uploaded_file.cr#L40","def":{"name":"extension","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"result = (File.extname(id))[1..-1]?\nif original_filename\n  result || (result = (File.extname(original_filename.not_nil!))[1..-1]?)\nend\nif result\n  result = result.downcase\nend\nresult\n"}},{"id":"gets_to_end(*args,**options)-instance-method","html_id":"gets_to_end(*args,**options)-instance-method","name":"gets_to_end","doc":null,"summary":null,"abstract":false,"args":[{"name":"args","doc":null,"default_value":"","external_name":"args","restriction":""}],"args_string":"(*args, **options)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/uploaded_file.cr#L38","def":{"name":"gets_to_end","args":[{"name":"args","doc":null,"default_value":"","external_name":"args","restriction":""}],"double_splat":{"name":"options","doc":null,"default_value":"","external_name":"options","restriction":""},"splat_index":0,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"io.gets_to_end(*args, **options)"}},{"id":"gets_to_end(*args,**options,&)-instance-method","html_id":"gets_to_end(*args,**options,&amp;)-instance-method","name":"gets_to_end","doc":null,"summary":null,"abstract":false,"args":[{"name":"args","doc":null,"default_value":"","external_name":"args","restriction":""}],"args_string":"(*args, **options, &)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/uploaded_file.cr#L38","def":{"name":"gets_to_end","args":[{"name":"args","doc":null,"default_value":"","external_name":"args","restriction":""}],"double_splat":{"name":"options","doc":null,"default_value":"","external_name":"options","restriction":""},"splat_index":0,"yields":1,"block_arg":null,"return_type":"","visibility":"Public","body":"io.gets_to_end(*args, **options) do |*yield_args|\n  yield *yield_args\nend"}},{"id":"id:String-instance-method","html_id":"id:String-instance-method","name":"id","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : String","source_link":null,"def":{"name":"id","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"@id"}},{"id":"id=(_id:String)-instance-method","html_id":"id=(_id:String)-instance-method","name":"id=","doc":null,"summary":null,"abstract":false,"args":[{"name":"_id","doc":null,"default_value":"","external_name":"_id","restriction":"String"}],"args_string":"(_id : String)","source_link":null,"def":{"name":"id=","args":[{"name":"_id","doc":null,"default_value":"","external_name":"_id","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@id = _id"}},{"id":"io:IO-instance-method","html_id":"io:IO-instance-method","name":"io","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : IO","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/uploaded_file.cr#L201","def":{"name":"io","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"IO","visibility":"Public","body":"(@io || (@io = _open)).not_nil!"}},{"id":"metadata:MetadataType-instance-method","html_id":"metadata:MetadataType-instance-method","name":"metadata","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : MetadataType","source_link":null,"def":{"name":"metadata","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"MetadataType","visibility":"Public","body":"@metadata"}},{"id":"metadata=(_metadata:MetadataType)-instance-method","html_id":"metadata=(_metadata:MetadataType)-instance-method","name":"metadata=","doc":null,"summary":null,"abstract":false,"args":[{"name":"_metadata","doc":null,"default_value":"","external_name":"_metadata","restriction":"MetadataType"}],"args_string":"(_metadata : MetadataType)","source_link":null,"def":{"name":"metadata=","args":[{"name":"_metadata","doc":null,"default_value":"","external_name":"_metadata","restriction":"MetadataType"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@metadata = _metadata"}},{"id":"mime_type-instance-method","html_id":"mime_type-instance-method","name":"mime_type","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/uploaded_file.cr#L54","def":{"name":"mime_type","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"metadata[\"mime_type\"]?.try(&.to_s)"}},{"id":"open(**options)-instance-method","html_id":"open(**options)-instance-method","name":"open","doc":"Calls `#open` on the storage to open the uploaded file for reading.\nMost storages will return a lazy IO object which dynamically\nretrieves file content from the storage as the object is being read.\n\nIf a block is given, the opened IO object is yielded to the block,\nand at the end of the block it's automatically closed. In this case\nthe return value of the method is the block return value.\n\nIf no block is given, the opened IO object is returned.\n\n```\nuploaded_file.open # => IO object returned by the storage\nuploaded_file.read # => \"...\"\nuploaded_file.close\n\n# or\n\nuploaded_file.open { |io| io.read } # the IO is automatically closed\n```\n","summary":"<p>Calls <code><a href=\"../Shrine/UploadedFile.html#open(**options)-instance-method\">#open</a></code> on the storage to open the uploaded file for reading.</p>","abstract":false,"args":[],"args_string":"(**options)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/uploaded_file.cr#L91","def":{"name":"open","args":[],"double_splat":{"name":"options","doc":null,"default_value":"","external_name":"options","restriction":""},"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"if @io\n  @io.not_nil!.close\nend\n@io = _open(**options)\n"}},{"id":"open(**options,&)-instance-method","html_id":"open(**options,&amp;)-instance-method","name":"open","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"(**options, &)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/uploaded_file.cr#L96","def":{"name":"open","args":[],"double_splat":{"name":"options","doc":null,"default_value":"","external_name":"options","restriction":""},"splat_index":null,"yields":1,"block_arg":null,"return_type":"","visibility":"Public","body":"open(**options)\nbegin\n  yield @io.not_nil!\nensure\n  close\n  @io = nil\nend\n"}},{"id":"opened?-instance-method","html_id":"opened?-instance-method","name":"opened?","doc":"Returns whether the file has already been opened.","summary":"<p>Returns whether the file has already been opened.</p>","abstract":false,"args":[],"args_string":"","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/uploaded_file.cr#L165","def":{"name":"opened?","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"!(!@io)"}},{"id":"original_filename-instance-method","html_id":"original_filename-instance-method","name":"original_filename","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/uploaded_file.cr#L62","def":{"name":"original_filename","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"metadata[\"filename\"]?.try(&.to_s)"}},{"id":"pos(*args,**options,&)-instance-method","html_id":"pos(*args,**options,&amp;)-instance-method","name":"pos","doc":null,"summary":null,"abstract":false,"args":[{"name":"args","doc":null,"default_value":"","external_name":"args","restriction":""}],"args_string":"(*args, **options, &)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/uploaded_file.cr#L37","def":{"name":"pos","args":[{"name":"args","doc":null,"default_value":"","external_name":"args","restriction":""}],"double_splat":{"name":"options","doc":null,"default_value":"","external_name":"options","restriction":""},"splat_index":0,"yields":1,"block_arg":null,"return_type":"","visibility":"Public","body":"io.pos(*args, **options) do |*yield_args|\n  yield *yield_args\nend"}},{"id":"pos(*args,**options)-instance-method","html_id":"pos(*args,**options)-instance-method","name":"pos","doc":null,"summary":null,"abstract":false,"args":[{"name":"args","doc":null,"default_value":"","external_name":"args","restriction":""}],"args_string":"(*args, **options)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/uploaded_file.cr#L37","def":{"name":"pos","args":[{"name":"args","doc":null,"default_value":"","external_name":"args","restriction":""}],"double_splat":{"name":"options","doc":null,"default_value":"","external_name":"options","restriction":""},"splat_index":0,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"io.pos(*args, **options)"}},{"id":"replace(io,**options)-instance-method","html_id":"replace(io,**options)-instance-method","name":"replace","doc":"Uploads a new file to this file's location and returns it.","summary":"<p>Uploads a new file to this file's location and returns it.</p>","abstract":false,"args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":""}],"args_string":"(io, **options)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/uploaded_file.cr#L181","def":{"name":"replace","args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":""}],"double_splat":{"name":"options","doc":null,"default_value":"","external_name":"options","restriction":""},"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"uploader.upload(io, **options, location: id)"}},{"id":"size-instance-method","html_id":"size-instance-method","name":"size","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/uploaded_file.cr#L48","def":{"name":"size","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"begin\n  metadata[\"size\"]?.try(&.to_i)\nrescue ArgumentError\n  nil\nend"}},{"id":"storage:Shrine::Storage::Base-instance-method","html_id":"storage:Shrine::Storage::Base-instance-method","name":"storage","doc":"Returns the storage that this file was uploaded to.","summary":"<p>Returns the storage that this file was uploaded to.</p>","abstract":false,"args":[],"args_string":" : Shrine::Storage::Base","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/uploaded_file.cr#L197","def":{"name":"storage","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Shrine::Storage::Base","visibility":"Public","body":"(Shrine.find_storage(storage_key.not_nil!)).not_nil!"}},{"id":"storage_key:String-instance-method","html_id":"storage_key:String-instance-method","name":"storage_key","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : String","source_link":null,"def":{"name":"storage_key","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"@storage_key"}},{"id":"storage_key=(_storage_key:String)-instance-method","html_id":"storage_key=(_storage_key:String)-instance-method","name":"storage_key=","doc":null,"summary":null,"abstract":false,"args":[{"name":"_storage_key","doc":null,"default_value":"","external_name":"_storage_key","restriction":"String"}],"args_string":"(_storage_key : String)","source_link":null,"def":{"name":"storage_key=","args":[{"name":"_storage_key","doc":null,"default_value":"","external_name":"_storage_key","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@storage_key = _storage_key"}},{"id":"stream(destination:IO,**options)-instance-method","html_id":"stream(destination:IO,**options)-instance-method","name":"stream","doc":"Streams uploaded file content into the specified destination. The\ndestination object is given directly to `IO.copy`.\n\nIf the uploaded file is already opened, it will be simply rewinded\nafter streaming finishes. Otherwise the uploaded file is opened and\nthen closed after streaming.\n\n```\nuploaded_file.stream(IO::Memory.new)\n```","summary":"<p>Streams uploaded file content into the specified destination.</p>","abstract":false,"args":[{"name":"destination","doc":null,"default_value":"","external_name":"destination","restriction":"IO"}],"args_string":"(destination : IO, **options)","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/uploaded_file.cr#L149","def":{"name":"stream","args":[{"name":"destination","doc":null,"default_value":"","external_name":"destination","restriction":"IO"}],"double_splat":{"name":"options","doc":null,"default_value":"","external_name":"options","restriction":""},"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"if opened?\n  IO.copy(io, destination)\n  io.rewind\nelse\n  open(**options) do |io|\n    IO.copy(io, destination)\n  end\nend"}},{"id":"to_json(json:JSON::Builder)-instance-method","html_id":"to_json(json:JSON::Builder)-instance-method","name":"to_json","doc":null,"summary":null,"abstract":false,"args":[{"name":"json","doc":null,"default_value":"","external_name":"json","restriction":"::JSON::Builder"}],"args_string":"(json : JSON::Builder)","source_link":null,"def":{"name":"to_json","args":[{"name":"json","doc":null,"default_value":"","external_name":"json","restriction":"::JSON::Builder"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"json.object do\n  _id = @id\n  if _id.nil?\n  else\n    json.field(\"id\") do\n      _id.to_json(json)\n    end\n  end\n  _storage_key = @storage_key\n  if _storage_key.nil?\n  else\n    json.field(\"storage_key\") do\n      _storage_key.to_json(json)\n    end\n  end\n  _metadata = @metadata\n  if _metadata.nil?\n  else\n    json.field(\"metadata\") do\n      _metadata.to_json(json)\n    end\n  end\nend"}},{"id":"uploader-instance-method","html_id":"uploader-instance-method","name":"uploader","doc":"Returns an uploader object for the corresponding storage.","summary":"<p>Returns an uploader object for the corresponding storage.</p>","abstract":false,"args":[],"args_string":"","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/uploaded_file.cr#L192","def":{"name":"uploader","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"Shrine.new(storage_key)"}},{"id":"url(**options):String-instance-method","html_id":"url(**options):String-instance-method","name":"url","doc":"Calls `#url` on the storage, forwarding any given URL options.","summary":"<p>Calls <code><a href=\"../Shrine/UploadedFile.html#url(**options):String-instance-method\">#url</a></code> on the storage, forwarding any given URL options.</p>","abstract":false,"args":[],"args_string":"(**options) : String","source_link":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/uploaded_file.cr#L170","def":{"name":"url","args":[],"double_splat":{"name":"options","doc":null,"default_value":"","external_name":"options","restriction":""},"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"storage.url(id, **options)"}}],"macros":[],"types":[{"html_id":"github.com/jetrockets/shrine.cr/Shrine/UploadedFile/MetadataType","path":"Shrine/UploadedFile/MetadataType.html","kind":"alias","full_name":"Shrine::UploadedFile::MetadataType","name":"MetadataType","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"shrine/uploaded_file.cr","line_number":5,"url":"https://github.com/jetrockets/shrine.cr/blob/e1f7e8658729e0cf7ed00ebc794dfd4591c36896/src/shrine/uploaded_file.cr"}],"repository_name":"github.com/jetrockets/shrine.cr","program":false,"enum":false,"alias":true,"aliased":"Hash(String, Int32 | Int64 | String | UInt32 | UInt64 | Nil)","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/jetrockets/shrine.cr/Shrine/UploadedFile","kind":"class","full_name":"Shrine::UploadedFile","name":"UploadedFile"},"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[]}]}]}]}}